<h3 class="heading">Case Pay Definition</h3>

<div class="main-div">
  <div class="provider" [formGroup]="providerForm">
    <div class="form-row align-items-center" >
      <div class="col-sm-2 my-1" >
        <mat-form-field><input placeholder="Provider Type" tabindex="1"  moveNextByMaxLength type="text" formControlName="providerType" matInput maxlength="1" [(ngModel)]='providerType'></mat-form-field>
        <mat-error *ngIf="hasError('providerType', 'required')">Provider Type is required</mat-error>
      </div>
    </div>
    <div class="form-row align-items-center" >
      <div class="col-sm-2 my-1" >
        <mat-form-field><input placeholder="Provider / Provider Group" tabindex="2"  moveNextByMaxLength type="text"  maxlength="8"  formControlName="providerCode" matInput [(ngModel)]='providerCode'></mat-form-field>
        <mat-error *ngIf="hasError('providerCode', 'required')">Provider Code is required</mat-error>
      </div>
    </div>


    <div id="providerDescription" *ngIf="showProviderDescription">
      <strong>Provider Description: </strong>{{this.providerDescription}}
    </div>

  </div>
  <div class="alert alert-danger" *ngIf="showError">
     {{ this.error }}
  </div>
  <div class="alert alert-success" *ngIf="showMessage">
    {{ this.successMessage }}
 </div>
  <button mat-button (click)="searchProvider()" mat-flat-button color="primary" class="search-button">Search Provider</button><br/><br/>
  <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
  <div>
  <table mat-table [dataSource]="dataSource" *ngIf="this.dataSource != null && this.dataSource.data.length" #mytable class="my-table mat-elevation-z8" class="table" >

    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef > Action </th>
      <td mat-cell *matCellDef="let element; let i = index" >
        <mat-form-field appearance="outline">
          <input matInput tabindex="{{(17 * (i + 1)) + 0}}" moveNextByMaxLength [(ngModel)]="element.Action" maxlength="1" >
        </mat-form-field><br/>
      </td>
    </ng-container>
    <ng-container matColumnDef="date">
      <th mat-header-cell *matHeaderCellDef> Date </th>
      <td mat-cell *matCellDef="let element; let i = index" >
        <mat-form-field appearance="outline" placeholder="On"><input  matInput tabindex="{{(17 * (i + 1)) + 1}}"  maxlength="8" [(ngModel)]="element.DateOn" moveNextByMaxLength></mat-form-field> <br/>
        <mat-form-field appearance="outline" placeholder="Off"><input matInput tabindex="{{(17 * (i + 1)) + 9}}"  maxlength="8" [(ngModel)]="element.DateOff" moveNextByMaxLength></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="servicecode1" >
      <th mat-header-cell *matHeaderCellDef> Service Code </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline" ><input matInput tabindex="{{(17 * (i + 1)) + 2}}" moveNextByMaxLength [(ngModel)]="element.CaseItemDetails[0].ServiceCode" maxlength="1"></mat-form-field> <br/>
        <mat-form-field appearance="outline" ><input matInput tabindex="{{(17 * (i + 1)) + 10}}" moveNextByMaxLength [(ngModel)]="element.CaseItemDetails[3].ServiceCode" maxlength="1" class="mat-input-invalid"></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="caseitem1">
      <th mat-header-cell *matHeaderCellDef> Case Item </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline"><input matInput moveNextByMaxLength [(ngModel)]="element.CaseItemDetails[0].CaseItemCode" tabindex="{{(17 * (i + 1)) + 3}}" maxlength="5" moveNextByMaxLength></mat-form-field> <br/>
        <mat-form-field appearance="outline"><input matInput moveNextByMaxLength [(ngModel)]="element.CaseItemDetails[3].CaseItemCode" tabindex="{{(17 * (i + 1)) + 11}}" maxlength="5" moveNextByMaxLength></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="servicecode2" >
      <th mat-header-cell *matHeaderCellDef> Service Code </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[1].ServiceCode" maxlength="1" tabindex="{{(17 * (i + 1)) + 4}}" moveNextByMaxLength></mat-form-field> <br/>
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[4].ServiceCode" maxlength="1" tabindex="{{(17 * (i + 1)) + 12}}" moveNextByMaxLength></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="caseitem2">
      <th mat-header-cell *matHeaderCellDef> Case Item </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[1].CaseItemCode" maxlength="5" tabindex="{{(17 * (i + 1)) + 5}}" moveNextByMaxLength></mat-form-field> <br/>
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[4].CaseItemCode" maxlength="5" tabindex="{{(17 * (i + 1)) + 13}}" moveNextByMaxLength></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="servicecode3" >
      <th mat-header-cell *matHeaderCellDef> Service Code </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[2].ServiceCode" maxlength="1" tabindex="{{(17 * (i + 1)) + 6}}" moveNextByMaxLength></mat-form-field> <br/>
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[5].ServiceCode" maxlength="1" tabindex="{{(17 * (i + 1)) + 14}}" moveNextByMaxLength></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="caseitem3">
      <th mat-header-cell *matHeaderCellDef> Case Item </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[2].CaseItemCode" maxlength="5" tabindex="{{(17 * (i + 1)) + 7}}" moveNextByMaxLength></mat-form-field> <br/>
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.CaseItemDetails[5].CaseItemCode" maxlength="5" tabindex="{{(17 * (i + 1)) + 15}}" moveNextByMaxLength></mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="illnesscodes">
      <th mat-header-cell *matHeaderCellDef> Illness/Item Codes </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.IllnessCodes1" tabindex="{{(17 * (i + 1)) + 8}}" maxlength="29" moveNextByMaxLength (keyup)="onKeyUp($event)"></mat-form-field> <br/>
        <mat-form-field appearance="outline"><input matInput [(ngModel)]="element.IllnessCodes2" tabindex="{{(17 * (i + 1)) + 16}}" maxlength="29" moveNextByMaxLength (keyup)="onKeyUp($event)"></mat-form-field>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns" class="header-row"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="header-row"></tr>
  </table>

 </div>
 <div class="form-row align-items-center" >
  <div class="col-sm-6 my-1" ><button mat-button (click)="updateRowData()" *ngIf="this.dataSource != null && this.dataSource.data.length" mat-flat-button color="accent" class="update-button">Update</button></div>
  <div class="col-sm-6 my-1" > <mat-paginator [pageSizeOptions]="[4, 8, 16, 32]" [pageSize]="4"></mat-paginator></div>
 </div>

</div>
